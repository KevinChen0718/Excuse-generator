<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ä¸æƒ³ä¸Šç­è—‰å£ç”¢ç”Ÿå™¨</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Apply Tailwind dark mode configuration
    tailwind.config = { darkMode: 'class' };
  </script>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Noto+Sans+TC:wght@400;700&display=swap"
    rel="stylesheet"
  >
  <style>
    /* åŸºæœ¬å­—é«”è¨­å®š */
    body {
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      /* å¢åŠ ä¸Šä¸‹ padding çµ¦å°è©±æ¡†ç•™å‡ºç©ºé–“ */
      padding-top: 2rem;
      padding-bottom: 2rem;
      /* ç¢ºä¿ body è‡³å°‘å’Œè¦–çª—ä¸€æ¨£é«˜ */
      min-height: 100vh;
      /* ä½¿ç”¨ flex å°‡å…§å®¹ç½®ä¸­ (å‚ç›´+æ°´å¹³) */
      display: flex;
      justify-content: center;
      align-items: center;
    }
    /* è©•åˆ†æŒ‰éˆ•æ¨£å¼ */
    .rating-button {
      transition: background-color .2s, transform .1s;
    }
    .rating-button:active {
      transform: scale(.95);
    }
    /* å°è©±æ¡†åŸºæœ¬æ¨£å¼ */
    #speech-bubble {
      /* åˆå§‹ç‹€æ…‹ */
      opacity: 0;
      transform: translateX(-50%) scale(0.95); /* åˆå§‹ç¸®æ”¾èˆ‡ä½ç§» */
      transform-origin: bottom center; /* è¨­å®šç¸®æ”¾å‹•ç•«çš„åŸé» */
      transition: opacity 0.3s ease-out, transform 0.3s ease-out; /* å¹³æ»‘éæ¸¡æ•ˆæœ */
      position: absolute;
      /* å®šä½åœ¨é ­åƒä¸Šæ–¹ï¼Œä¸¦ç•™å‡º 10px é–“è· */
      bottom: calc(100% + 10px);
      left: 50%;
      min-width: 200px; /* æœ€å°å¯¬åº¦ */
      pointer-events: none; /* åˆå§‹ä¸å¯äº¤äº’ */
    }
    /* å°è©±æ¡†å¯è¦‹ç‹€æ…‹ */
    #speech-bubble.visible {
        opacity: 1;
        transform: translateX(-50%) scale(1); /* æ¢å¾©æ­£å¸¸å¤§å° */
        pointer-events: auto; /* å¯è¦‹æ™‚å¯äº¤äº’ */
    }
    /* å°è©±æ¡†ç®­é ­ (æ·ºè‰²æ¨¡å¼) */
    #speech-bubble::after {
      content: '';
      position: absolute;
      bottom: -10px; /* æŒ‡å‘ä¸‹æ–¹ */
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 10px solid transparent;
      border-right: 10px solid transparent;
      /* ç®­é ­é¡è‰²èˆ‡æ·ºè‰²èƒŒæ™¯ä¸€è‡´ */
      border-top: 10px solid white; /* Tailwind bg-white */
      transition: border-color 0.3s ease-out; /* é¡è‰²è®ŠåŒ–ä¹ŸåŠ ä¸Šéæ¸¡ */
    }
    /* å°è©±æ¡†ç®­é ­ (æ·±è‰²æ¨¡å¼) */
    .dark #speech-bubble::after {
        /* ç®­é ­é¡è‰²èˆ‡æ·±è‰²èƒŒæ™¯ä¸€è‡´ */
        border-top-color: #374151; /* Tailwind dark:bg-gray-700 */
    }
    /* å­ä¸–è‡‰äº’å‹•æ•ˆæœ */
    #worker-face {
        cursor: pointer;
        transition: transform 0.2s ease;
    }
    #worker-face:hover {
        transform: scale(1.05);
    }
    #worker-face:active {
        transform: scale(0.98);
    }
  </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 transition-colors duration-300">

  <button
    id="theme-toggle"
    class="fixed top-4 right-4 p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-xl shadow-md hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors"
    aria-label="åˆ‡æ›ä¸»é¡Œ"
  >
    <span>ğŸŒ™</span>
  </button>

  <div class="main-container relative text-center p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-md w-full mx-auto transition-colors duration-300">
    <h1 class="text-2xl font-bold mb-6 text-gray-800 dark:text-gray-100">
      ä»Šå¤©ä¸æƒ³ä¸Šç­ï¼Ÿé»å¤§é ­æ‰¾è—‰å£ï¼
    </h1>

    <div class="relative inline-block mb-6">
      <svg
        id="worker-face"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 100 100"
        class="w-24 sm:w-32 h-auto mx-auto text-gray-600 dark:text-gray-400"
      >
        <circle cx="50" cy="50" r="45" class="fill-gray-200 dark:fill-gray-600 stroke-gray-400 dark:stroke-gray-500 transition-colors" stroke-width="2"/>
        <circle cx="35" cy="47" r="4.5" class="fill-gray-600 dark:fill-gray-300 transition-colors"/>
        <circle cx="65" cy="47" r="4.5" class="fill-gray-600 dark:fill-gray-300 transition-colors"/>
        <path d="M27 54 Q35 61 43 54" class="stroke-gray-400 dark:stroke-gray-500 transition-colors" stroke-width="2.5" fill="none"/>
        <path d="M57 54 Q65 61 73 54" class="stroke-gray-400 dark:stroke-gray-500 transition-colors" stroke-width="2.5" fill="none"/>
        <path d="M30 72 Q50 70 70 72" class="stroke-gray-500 dark:stroke-gray-400 transition-colors" stroke-width="3.5" fill="none"/>
        <path d="M40 15 Q45 5 50 15" class="stroke-gray-500 dark:stroke-gray-400 transition-colors" stroke-width="2" fill="none"/>
        <path d="M50 15 Q55 5 60 15" class="stroke-gray-500 dark:stroke-gray-400 transition-colors" stroke-width="2" fill="none"/>
        <path d="M45 18 Q50 8 55 18" class="stroke-gray-500 dark:stroke-gray-400 transition-colors" stroke-width="2" fill="none"/>
      </svg>
      <div
        id="speech-bubble"
        class="bg-white dark:bg-gray-700 p-4 rounded-lg shadow-md max-w-xs text-left"
        >
        <p id="excuse-text" class="text-gray-700 dark:text-gray-200">...</p>
      </div>
    </div>

    <div id="rating-section" class="mt-6 hidden">
      <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">
        é€™å€‹è—‰å£çš„å¯ä¿¡åº¦ï¼Ÿ (1=é¬¼æ‰ä¿¡, 5=å¥½åƒå¯ä»¥å–”)
      </p>
      <div class="flex flex-wrap justify-center gap-2">
        <button class="rating-button bg-red-200 hover:bg-red-300 text-red-800 font-bold py-1 px-3 rounded-full text-sm" onclick="rateExcuse(1)">1</button>
        <button class="rating-button bg-orange-200 hover:bg-orange-300 text-orange-800 font-bold py-1 px-3 rounded-full text-sm" onclick="rateExcuse(2)">2</button>
        <button class="rating-button bg-yellow-200 hover:bg-yellow-300 text-yellow-800 font-bold py-1 px-3 rounded-full text-sm" onclick="rateExcuse(3)">3</button>
        <button class="rating-button bg-lime-200 hover:bg-lime-300 text-lime-800 font-bold py-1 px-3 rounded-full text-sm" onclick="rateExcuse(4)">4</button>
        <button class="rating-button bg-green-200 hover:bg-green-300 text-green-800 font-bold py-1 px-3 rounded-full text-sm" onclick="rateExcuse(5)">5</button>
      </div>
      <p id="rating-feedback" class="text-xs text-gray-500 dark:text-gray-400 mt-2 h-4"></p>
    </div>

    <div id="copy-section" class="mt-4 hidden"> <button id="copy-excuse" class="rating-button bg-blue-200 hover:bg-blue-300 dark:bg-blue-600 dark:hover:bg-blue-500 text-blue-800 dark:text-white font-bold py-1.5 px-4 rounded-full text-sm transition-colors"> ğŸ“‹ è¤‡è£½è—‰å£
      </button>
      <span id="copy-feedback" class="ml-2 text-xs text-green-600 dark:text-green-400"></span>
    </div>
  </div>

  <script>
    // --- DOM å…ƒç´ ç²å– ---
    const themeToggle   = document.getElementById('theme-toggle');
    const themeIcon     = themeToggle.querySelector('span'); // ç²å–æŒ‰éˆ•å…§çš„åœ–æ¨™ span
    const root          = document.documentElement; // HTML æ ¹å…ƒç´ 
    const workerFace    = document.getElementById('worker-face');
    const speechBubble  = document.getElementById('speech-bubble');
    const excuseText    = document.getElementById('excuse-text');
    const ratingSection = document.getElementById('rating-section');
    const ratingFeedback= document.getElementById('rating-feedback');
    const copySection   = document.getElementById('copy-section');
    const copyBtn       = document.getElementById('copy-excuse');
    const copyFb        = document.getElementById('copy-feedback');
    let ratingTimeout; // è©•åˆ†å›é¥‹è¨ˆæ™‚å™¨
    let copyTimeout;   // è¤‡è£½å›é¥‹è¨ˆæ™‚å™¨

    // --- ä¸»é¡Œåˆ‡æ›é‚è¼¯ ---
    function applyTheme(theme) {
      if (theme === 'dark') {
        root.classList.add('dark');
        themeIcon.textContent = 'â˜€ï¸'; // æ·±è‰²æ¨¡å¼é¡¯ç¤ºå¤ªé™½
        localStorage.setItem('theme', 'dark');
      } else {
        root.classList.remove('dark');
        themeIcon.textContent = 'ğŸŒ™'; // æ·ºè‰²æ¨¡å¼é¡¯ç¤ºæœˆäº®
        localStorage.setItem('theme', 'light');
      }
    }

    // åˆå§‹åŒ–ä¸»é¡Œï¼šæª¢æŸ¥æœ¬åœ°å„²å­˜æˆ–ç³»çµ±åå¥½
    const savedTheme = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const initialTheme = savedTheme || (prefersDark ? 'dark' : 'light');
    applyTheme(initialTheme);

    // ä¸»é¡Œåˆ‡æ›æŒ‰éˆ•äº‹ä»¶
    themeToggle.addEventListener('click', () => {
      const newTheme = root.classList.contains('dark') ? 'light' : 'dark';
      applyTheme(newTheme);
    });

    // --- è—‰å£åˆ—è¡¨ ---
    const excuses = [
      "æˆ‘å®¶çš„è²“å­¸æœƒäº†ä¸Šç¶²ï¼Œç¾åœ¨ç‰ æ­£åœ¨ç”¨æˆ‘çš„é›»è…¦ä¸‹å–®ä¸€å™¸çš„è²“è–„è·ï¼Œæˆ‘å¾—é˜»æ­¢ç‰ ï¼",
      "æˆ‘è¢«ä¸€ç¾¤æœƒè·³è¸¢è¸èˆçš„é´¿å­åŒ…åœäº†ï¼Œç‰ å€‘è¦æ±‚æˆ‘åŠ å…¥ç‰ å€‘çš„èˆåœ˜ï¼Œæˆ‘èµ°ä¸é–‹ã€‚",
      "æˆ‘çš„å·¦è…³å¤§æ‹‡æŒ‡çªç„¶è¦ºé†’äº†å“²å­¸æ„è­˜ï¼Œæ­£åœ¨æ€è€ƒå­˜åœ¨çš„æ„ç¾©ï¼Œæˆ‘å¿…é ˆå°Šé‡ç‰ çš„ç©ºé–“ã€‚",
      "æˆ‘æ˜¨å¤©å¤¢åˆ°è‡ªå·±è®Šæˆäº†ä¸€é¡†é¦¬éˆ´è–¯ï¼Œä»Šå¤©é‚„æ²’å®Œå…¨å¾é¦¬éˆ´è–¯çš„ç‹€æ…‹æ¢å¾©éä¾†ã€‚",
      "æˆ‘çš„å½±å­é¬§è„¾æ°£é›¢å®¶å‡ºèµ°äº†ï¼Œæˆ‘å¾—å…ˆæ‰¾åˆ°ç‰ æ‰èƒ½å‡ºé–€ï¼Œä¸ç„¶ä¸å‰åˆ©ã€‚",
      "å¤–æ˜ŸäººæŠŠæˆ‘çš„é¬§é˜å·èµ°äº†ï¼Œé‚„ç•™ä¸‹å­—æ¢èªªè¦åšã€æ™‚é–“å¯¦é©—ã€ã€‚",
      "æˆ‘ä¸å°å¿ƒæŠŠå’–å•¡å€’åœ¨éµç›¤ä¸Šï¼Œç¾åœ¨å®ƒæ¯æ‰“ä¸€å€‹å­—éƒ½æœƒè‡ªå‹•åŠ ä¸Šã€å–µã€ï¼Œæˆ‘éœ€è¦ä¿®ç†å®ƒã€‚",
      "æˆ‘å®¶çš„ç›†æ ½çªç„¶é•·å‡ºäº†è…¿ï¼Œé‚„èªªè¦å»ç’°éŠä¸–ç•Œï¼Œæˆ‘å¾—å»æ©Ÿå ´é€é€å®ƒã€‚",
      "æˆ‘ç™¼ç¾æˆ‘çš„éˆé­‚è·Ÿéš”å£é„°å±…çš„ç‹—äº¤æ›äº†ï¼Œç¾åœ¨æ±ªæ±ªå«æ‰æ˜¯æˆ‘æ­£å¸¸çš„æºé€šæ–¹å¼ã€‚",
      "é¾æ²é¢¨æŠŠæˆ‘çš„å‡é«®å¹èµ°äº†ï¼Œé‚£æ˜¯æˆ‘çš„æœ¬é«”ï¼Œæ‰¾ä¸åˆ°å°±ç„¡æ³•å‡ºé–€ã€‚",
      "æˆ‘çš„åºŠä»Šå¤©ç‰¹åˆ¥æœ‰å¸å¼•åŠ›ï¼Œç‰©ç†å­¸å®¶æ‡‰è©²ç ”ç©¶ä¸€ä¸‹é€™å€‹ç¾è±¡ï¼Œæˆ‘è‡ªé¡˜ç•¶å¯¦é©—å“ã€‚",
      "æˆ‘æ­£åœ¨è·Ÿæˆ‘çš„å®¤å…§ç°å¡µé€²è¡Œä¸€å ´åš´è‚…çš„è«‡åˆ¤ï¼Œé—œæ–¼é ˜åœŸåŠƒåˆ†å•é¡Œã€‚",
      "ç‚ºäº†éŸ¿æ‡‰ç’°ä¿ï¼Œæˆ‘æ±ºå®šä»Šå¤©é€éå…‰åˆä½œç”¨ç²å–èƒ½é‡ï¼Œæš«æ™‚ä¸éœ€è¦ç§»å‹•ã€‚",
      "æˆ‘å®¶çš„æ™ºæ…§éŸ³ç®±çªç„¶é–‹å§‹å”±é¥’èˆŒï¼Œè€Œä¸”åœä¸ä¸‹ä¾†ï¼Œè²éŸ³å¤ªå¤§æˆ‘ç„¡æ³•æ€è€ƒã€‚",
      "æˆ‘è¢«å›°åœ¨è‡ªå·±çš„æ¯›è¡£è£¡äº†ï¼Œå®ƒå¥½åƒç¸®æ°´äº†ï¼Œæˆ–è€…æˆ‘è®Šèƒ–äº†ï¼Ÿéœ€è¦å°ˆæ¥­æ•‘æ´ã€‚",
      "æˆ‘çš„ç‰™è†ç”¨å®Œäº†ï¼Œæ ¹æ“šå¤è€çš„å®¶æ—å‚³çµ±ï¼Œæ‰¾ä¸åˆ°æ–°ç‰™è†å‰ä¸èƒ½èˆ‡å¤–ç•Œäº¤æµã€‚",
      "æˆ‘é æ„Ÿä»Šå¤©æœƒé‡åˆ°å‘½ä¸­è¨»å®šçš„é‚£å€‹äººï¼Œä½†åœ°é»æ˜¯åœ¨æˆ‘å®¶æ²™ç™¼ä¸Šï¼Œæ‰€ä»¥æˆ‘ä¸èƒ½é›¢é–‹ã€‚",
      "æˆ‘çš„æƒ³åƒæœ‹å‹ä»Šå¤©ç”Ÿæ—¥ï¼Œæˆ‘è¦åœ¨å®¶å¹«ä»–è¾¦æ´¾å°ï¼Œä»–æœƒå‚·å¿ƒçš„å¦‚æœæˆ‘ä¸åœ¨ã€‚",
      "æˆ‘ä¸å°å¿ƒåä¸‹äº†ä¸€é¡†æ¨‚é«˜ç©æœ¨ï¼Œç¾åœ¨èµ°è·¯æœƒç™¼å‡ºå–€æ‹‰å–€æ‹‰çš„è²éŸ³ï¼Œå¤ªå°·å°¬äº†ã€‚",
      "æˆ‘å®¶çš„ç¶²è·¯è·¯ç”±å™¨æˆç²¾äº†ï¼Œå®ƒè¦æ±‚æˆ‘å¿…é ˆå…ˆå›ç­”ä¸‰å€‹å“²å­¸å•é¡Œæ‰èƒ½ä¸Šç¶²ï¼Œæˆ‘å¡é—œäº†ã€‚",
      "æˆ‘çš„ Wi-Fi è·¯ç”±å™¨è¦æ±‚ç”¨æ¯”ç‰¹å¹£æ”¯ä»˜è´–é‡‘æ‰è®“æˆ‘é€£ç·šã€‚",
      "åšæ‰‹å·¥è—æ™‚ä¸å°å¿ƒæŠŠå…©éš»æ‰‹é»åœ¨ä¸€èµ·äº†ï¼Œæ­£åœ¨ç­‰å¾…å¼·åŠ›è† æº¶è§£ã€‚",
      "ä¸€ç¾¤é·å¾™ä¸­çš„è´è¶é¸æ“‡äº†æˆ‘å®¶é–€å£ä½œç‚ºä¼‘æ¯é»ï¼Œç•«é¢å¤ªç¾æˆ‘ä¸æ•¢æ‰“æ“¾ç‰ å€‘ã€‚",
      "é¡å­è£¡çš„æˆ‘ä¸åªè·Ÿæˆ‘æ­è©±ï¼Œé‚„çµ¦äº†æˆ‘ç³Ÿç³•çš„äººç”Ÿå»ºè­°ï¼Œæˆ‘éœ€è¦æ™‚é–“æ¶ˆåŒ–ä¸€ä¸‹ã€‚",
      "æˆ‘æ­£åœ¨è·Ÿæˆ‘çš„è²“é€²è¡Œä¸€å ´æ„å¿—åŠ›çš„å°æ±ºï¼ˆçªçœ¼æ¯”è³½ï¼‰ï¼Œæˆ‘æ±ºå¿ƒè¦è´ï¼Œå¯èƒ½è¦èŠ±å¥½å¹¾å€‹å°æ™‚ã€‚",
      "æˆ‘çš„å¹¸é‹è¥ªæ´—äº†é‚„æ²’ä¹¾ï¼Œæ²’æœ‰å®ƒå€‘æˆ‘ç„¡æ³•é¢å°ä»Šå¤©ã€‚",
      "ä½åœ¨æˆ‘å®¶çš„é¬¼åˆæŠŠæˆ‘çš„é‘°åŒ™è—èµ·ä¾†äº†ï¼Œæˆ‘å€‘ä¹‹é–“çš„é—œä¿‚çœŸçš„å¾ˆè¤‡é›œã€‚",
      "æˆ‘ä¸å°å¿ƒæŠŠéš±å½¢å¢¨æ°´ç‘åˆ°æˆ‘çš„å·¥ä½œæœä¸Šäº†ï¼Œç¾åœ¨æˆ‘æ‰¾ä¸åˆ°å®ƒå€‘ã€‚",
      "æˆ‘çš„å…§å¿ƒç¨ç™½çªç„¶åˆ‡æ›æˆäº†ä¸€ç¨®æˆ‘è½ä¸æ‡‚çš„èªè¨€ï¼Œéå¸¸æ··äº‚ã€‚",
      "æˆ‘æ­£åœ¨å˜—è©¦æ•™æˆ‘çš„é‡‘é­šå­¸æœƒã€Œæ’¿å›ä¾†ã€é€™å€‹æŒ‡ä»¤ï¼Œé€²åº¦ç•°å¸¸ç·©æ…¢ã€‚",
      "ä¸€è‚¡å­¸ç¿’è˜‡æ ¼è˜­é¢¨ç¬›çš„è¡å‹•çªç„¶æ·¹æ²’äº†æˆ‘ï¼Œå¿…é ˆç«‹åˆ»æ‰¾åˆ°é¢¨ç¬›ã€‚",
      "æˆ‘çš„é ­é«®å®£å¸ƒç¨ç«‹äº†ï¼Œå®ƒæ‹’çµ•è¢«æ¢³ç†æˆä»»ä½•é€ å‹ã€‚",
      "æˆ‘æ­£å’Œæˆ‘çš„çƒ¤éºµåŒ…æ©Ÿå°±ã€Œé…¥è„†åº¦ã€çš„å®šç¾©é€²è¡Œä¸€å ´æ¿€çƒˆçš„å“²å­¸è¾¯è«–ã€‚",
      "åœ°æ¿ä»Šå¤©æ±ºå®šè®Šæˆå²©æ¼¿ï¼Œæˆ‘é‚„æ²’æ‰¾åˆ°é€šå¾€é–€å£çš„å®‰å…¨è·¯å¾‘ã€‚",
      "æˆ‘æ”¶è—çš„ç¨€æœ‰ç“¶è“‹æ€¥éœ€æŒ‰ç…§å­—æ¯é †åºé‡æ–°æ’åˆ—ï¼Œé€™éå¸¸é‡è¦ã€‚",
      "æˆ‘ä»Šå¤©è·Ÿæˆ‘çš„æ²™ç™¼ç£å ´ç‰¹åˆ¥åˆï¼Œç‰©ç†ä¸Šåˆ†ä¸é–‹äº†ã€‚",
      "æˆ‘çš„å’–å•¡æ¯æŠŠæˆ‘çš„å·¥ä½œå‹•åŠ›ç•¶ä½œäººè³ªäº†ï¼Œè«‡åˆ¤æ­£åœ¨é€²è¡Œä¸­ã€‚",
      "æˆ‘ä¸å°å¿ƒé€²å…¥äº†ä¸€å€‹è¥ªå­ç¸½æ˜¯åœ¨çƒ˜ä¹¾æ©Ÿè£¡æ¶ˆå¤±çš„å¹³è¡Œæ™‚ç©ºï¼Œæ­£åœ¨åŠªåŠ›æ‰¾è·¯å›ä¾†ã€‚",
      "æˆ‘å®¶é™¢å­è£¡çš„æ¾é¼ æˆç«‹äº†å·¥æœƒï¼Œæ­£åœ¨æˆ‘å®¶å‰é–€ç½·å·¥æŠ—è­°ã€‚",
      "æˆ‘çš„å¤§è…¦ç›®å‰æ­£åœ¨ç·©è¡è™•ç†ä¸­ï¼Œè«‹ç¨å€™..."
    ];

    // --- æ ¸å¿ƒåŠŸèƒ½ ---

    // é¡¯ç¤ºå°è©±æ¡†
    function showBubble() {
        speechBubble.classList.add('visible');
    }

    // éš±è—å°è©±æ¡†
    function hideBubble() {
        speechBubble.classList.remove('visible');
    }

    // é»æ“Šé ­åƒï¼šç”¢ç”Ÿè—‰å£ä¸¦é¡¯ç¤º
    workerFace.addEventListener('click', e => {
      e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡åˆ° document
      // éš¨æ©Ÿé¸å–è—‰å£
      const randomExcuse = excuses[Math.floor(Math.random() * excuses.length)];
      excuseText.textContent = randomExcuse; // è¨­å®šè—‰å£æ–‡å­—

      showBubble(); // é¡¯ç¤ºå°è©±æ¡†

      ratingSection.classList.remove('hidden'); // é¡¯ç¤ºè©•åˆ†å€
      copySection.classList.remove('hidden');   // é¡¯ç¤ºè¤‡è£½å€
      ratingFeedback.textContent = '';        // æ¸…é™¤èˆŠçš„è©•åˆ†å›é¥‹
      copyFb.textContent = '';                // æ¸…é™¤èˆŠçš„è¤‡è£½å›é¥‹
      clearTimeout(ratingTimeout);            // æ¸…é™¤è©•åˆ†è¨ˆæ™‚å™¨
      clearTimeout(copyTimeout);              // æ¸…é™¤è¤‡è£½è¨ˆæ™‚å™¨
    });

    // è©•åˆ†åŠŸèƒ½
    window.rateExcuse = function(score) { // å°‡å‡½æ•¸æ›è¼‰åˆ° window ä½¿ onclick å¯ä»¥èª¿ç”¨
      console.log(`ä½¿ç”¨è€…è©•åˆ†: ${score}`); // æ§åˆ¶å°è¼¸å‡º (å¯é¸)
      let feedback = '';
      switch(score){
        case 1: feedback="å—¯...é€™è—‰å£é€£é¬¼éƒ½ä¸ä¿¡å§ï¼Ÿ"; break;
        case 2: feedback="é€™å€‹...å¯èƒ½éœ€è¦ä¸€é»æƒ³åƒåŠ›ã€‚"; break;
        case 3: feedback="æœ‰é»æ„æ€ï¼Œä½†ç ´ç¶»ä¸å°‘ã€‚"; break;
        case 4: feedback="èªªä¸å®š...çœŸçš„æœ‰å¯èƒ½ï¼Ÿ"; break;
        case 5: feedback="å®Œç¾ï¼è€é—†ä¸€å®šæœƒç›¸ä¿¡çš„ï¼ï¼ˆå¤§æ¦‚å§ï¼‰"; break;
      }
      ratingFeedback.textContent = feedback; // é¡¯ç¤ºè©•åˆ†å›é¥‹

      // æ¸…é™¤èˆŠè¨ˆæ™‚å™¨ä¸¦è¨­å®šæ–°è¨ˆæ™‚å™¨ï¼Œ3ç§’å¾Œæ¸…é™¤å›é¥‹
      clearTimeout(ratingTimeout);
      ratingTimeout = setTimeout(() => ratingFeedback.textContent = '', 3000);

      // ç¨å¾®å»¶é²å¾Œéš±è—å°è©±æ¡†
      setTimeout(hideBubble, 500);
    }

    // è¤‡è£½åŠŸèƒ½
    copyBtn.addEventListener('click', (e) => {
      e.stopPropagation(); // é˜²æ­¢è§¸ç™¼ document çš„é»æ“Šäº‹ä»¶
      const textToCopy = excuseText.textContent;
      if (navigator.clipboard && textToCopy) {
        navigator.clipboard.writeText(textToCopy)
          .then(() => {
            copyFb.textContent = 'å·²è¤‡è£½ï¼'; // é¡¯ç¤ºæˆåŠŸè¨Šæ¯
            // æ¸…é™¤èˆŠè¨ˆæ™‚å™¨ä¸¦è¨­å®šæ–°è¨ˆæ™‚å™¨ï¼Œ2ç§’å¾Œæ¸…é™¤è¨Šæ¯
            clearTimeout(copyTimeout);
            copyTimeout = setTimeout(() => copyFb.textContent = '', 2000);
          })
          .catch(err => {
            console.error('è¤‡è£½å¤±æ•—:', err); // æ§åˆ¶å°è¼¸å‡ºéŒ¯èª¤
            copyFb.textContent = 'è¤‡è£½å¤±æ•—'; // é¡¯ç¤ºå¤±æ•—è¨Šæ¯
            clearTimeout(copyTimeout);
            copyTimeout = setTimeout(() => copyFb.textContent = '', 2000);
          });
      } else {
          // é™ç´šè™•ç†æˆ–æç¤º (å¦‚æœéœ€è¦æ”¯æ´èˆŠç€è¦½å™¨)
          copyFb.textContent = 'ç€è¦½å™¨ä¸æ”¯æ´';
          clearTimeout(copyTimeout);
          copyTimeout = setTimeout(() => copyFb.textContent = '', 2000);
      }
    });

    // --- å…¨å±€é»æ“Šäº‹ä»¶ï¼šéš±è—å°è©±æ¡† ---
    document.addEventListener('click', e => {
      // æª¢æŸ¥å°è©±æ¡†æ˜¯å¦å¯è¦‹ï¼Œä¸”é»æ“Šçš„ç›®æ¨™ä¸æ˜¯é ­åƒã€ä¹Ÿä¸æ˜¯è©•åˆ†å€æˆ–è¤‡è£½å€å…§çš„å…ƒç´ 
      if (speechBubble.classList.contains('visible') &&
          !workerFace.contains(e.target) &&
          !ratingSection.contains(e.target) &&
          !copySection.contains(e.target)) {
        hideBubble(); // éš±è—å°è©±æ¡†
        ratingFeedback.textContent = ''; // åŒæ­¥æ¸…é™¤è©•åˆ†å›é¥‹
        clearTimeout(ratingTimeout);     // æ¸…é™¤è©•åˆ†è¨ˆæ™‚å™¨
      }
    });

    // --- é˜»æ­¢äº‹ä»¶å†’æ³¡ ---
    // é˜²æ­¢é»æ“Šè©•åˆ†å€æˆ–è¤‡è£½å€æ™‚ï¼Œè§¸ç™¼ document çš„é»æ“Šäº‹ä»¶å°è‡´å°è©±æ¡†é—œé–‰
    ratingSection.addEventListener('click', e => e.stopPropagation());
    copySection.addEventListener('click', e => e.stopPropagation()); // è¤‡è£½å€ä¹Ÿéœ€è¦é˜»æ­¢å†’æ³¡

  </script>
</body>
</html>

